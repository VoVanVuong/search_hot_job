<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Facebook Messenger-like Chat</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
        crossorigin="anonymous" />
  <!-- Thêm Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Thêm các thư viện cần thiết cho Bootstrap 5 -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      height: 100%;

    }

    .chat-container {
      /* max-width: 600px; */
      margin: 20px auto;
      border: 1px solid #ccc;
      border-radius: 8px;
      overflow: hidden;
    }

    .chat-header {
      background-color: #0084ff;
      color: #fff;
      padding: 10px;
      text-align: center;
    }

    .chat-messages {
      padding: 10px;
      overflow-y: auto;
      max-width: 100%;
    }

    .message {
      margin-bottom: 10px;
      padding: 8px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      /* Center the avatar vertically */
    }


    .message.sent {
      background-color: #0084ff;
      color: #fff;
      margin-left: auto;
      display: inline-block;
      display: block;
      max-width: 250px;
      /* Set your desired maximum width */
      word-wrap: break-word;
      padding: 8px;
      border-radius: 8px;
      text-align: right;
    }

    .message.sent {
      background-color: #0084ff;
      color: #fff;
      margin-left: auto;
      display: inline-block;
      width: fit-content;
      display: block;
      max-width: 550px;
      /* Set your desired maximum width */
      word-wrap: break-word;
      padding: 8px;
      border-radius: 8px;
      text-align: left;
      box-sizing: border-box;
      /* Include padding and border in the width calculation */
    }

    .message.received {
      background-color: #f0f0f0;
      color: #000;
      align-self: flex-start;
      display: inline-block;
      max-width: 450px;
      height: fixed;
      word-wrap: break-word;
    }

    .avatar {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      margin-right: 10px;
      margin-left: 10px;

    }

    .message.sent .avatar {
      float: right;
    }

    .message.received .avatar {
      float: left;
    }

    .message.sent img {
      max-width: 250px;
      height: auto;
    }

    .message-form {
      display: flex;
      flex-direction: row;
      padding: 10px;
      background-color: #f9f9f9;
      border-top: 1px solid #ccc;
    }


    .message-form input[type="file"] {
      margin-right: 20px;
    }



    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      justify-content: center;
      align-items: center;
      overflow: auto;
    }

    .modal-content {
      max-width: 80%;
      max-height: 80%;
      position: relative;
    }

    .modal img {
      width: 100%;
      height: auto;
      max-height: 100%;
      object-fit: contain;
    }

    .close {
      position: absolute;
      top: 10px;
      right: 10px;
      color: #fff;
      font-size: 20px;
      cursor: pointer;
    }

    .close:hover {
      color: #ccc;
    }

    .message.sent .fa-file-pdf {
      font-size: 24px;
      color: #fff;
      margin-right: 10px;
    }


  </style>
</head>

<body>
<!-- Navbar Start -->
<nav class="navbar navbar-expand-lg bg-white navbar-light shadow sticky-top p-0">
  <a href="index.html" class="navbar-brand d-flex align-items-center text-center py-0 px-4 px-lg-5">
    <h1 class="m-0 text-primary">5Job</h1>
  </a>
  <button type="button" class="navbar-toggler me-4" data-bs-toggle="collapse"
          data-bs-target="#navbarCollapse">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarCollapse">
    <div class="navbar-nav ms-auto p-4 p-lg-0">
      <a href="index.html" class="nav-item nav-link active">Home</a>
      <a href="" class="nav-item nav-link">Companies</a>
      <a href="" class="nav-item nav-link">5Job tool</a>
      <a href="" class="nav-item nav-link">CV</a>
      <div class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Login</a>
        <div class="dropdown-menu rounded-0 m-0">
          <a href="" class="dropdown-item">Login</a>
          <a href="" class="dropdown-item">register</a>
          <a href="" class="dropdown-item">My 5job</a>
          <a href="" class="dropdown-item">my resumes</a>
          <a href="saved-job.html" class="dropdown-item">Saved jobs</a>
          <a href="" class="dropdown-item">Applied jobs</a>
          <a href="" class="dropdown-item">Job alerts</a>
          <a href="" class="dropdown-item">My account</a>
        </div>
      </div>
    </div>
    <a href="" class="btn btn-primary rounded-0 py-4 px-lg-5 d-none d-lg-block">Employers<i
            class="fa fa-arrow-right ms-3"></i></a>
  </div>
</nav>
<!-- Navbar End -->
<div style="height: 70vh;" class="row h-100">
  <div class="col-md-3" >
    <div class="chat-list" style="margin-left: 20px;">
      <div class="row g-2">
        <div class="col-md-12">
          <div class="row">
            <div class="col-md-8">
              <input type="text" class="form-control border-2" placeholder="Keyword" />
            </div>
            <div class="col-md-4">
              <button class="btn btn-dark border-0 w-100">Search</button>
            </div>
          </div>
        </div>

      </div>
      <ul class="list-group" style="overflow-y: auto;height: 80vh;">
        <li class=" m-1 list-group-item">
          <div class="row">
            <div class="col" style="padding: 0; border-radius: 8px; overflow: hidden;">
              <a href="" class="link" style="color: rgb(56, 88, 152); text-decoration: none;">
                <div class="d-flex">
                  <img src="avata.jpg" alt="Kỳ Hoài" style="width: 50px; border-radius: 50%; object-fit: cover; height: 50px;">
                  <div class="ms-3">
                    <div class="fw-bold">Đình Cảnh <span class="text-muted">20:00 01/02/2001</span></div>
                    <div class="text-muted">Bạn: 8r đi chơi đc ko</div>
                  </div>
                </div>
              </a>
            </div>
          </div>
        </li>
        <li class=" m-1 list-group-item">
          <div class="row">
            <div class="col" style="padding: 0; border-radius: 8px; overflow: hidden;">
              <a href="" class="link" style="color: rgb(56, 88, 152); text-decoration: none;">
                <div class="d-flex">
                  <img src="avata.jpg" alt="Kỳ Hoài" style="width: 50px; border-radius: 50%; object-fit: cover; height: 50px;">
                  <div class="ms-3">
                    <div class="fw-bold">Đình Cảnh <span class="text-muted">20:00 01/02/2001</span></div>
                    <div class="text-muted">Bạn: 8r đi chơi đc ko</div>
                  </div>
                </div>
              </a>
            </div>
          </div>
        </li>





        <!-- Add more users as needed -->
      </ul>
    </div>
  </div>
  <div class=" col-md-9">
    <div class="chat-header"><span><i class="bi bi-trash" style="font-size: 2rem;"></i></span>Cảnh Hồ</div>
    <div style="height:65vh;" class="chat-messages" id="chat-messages">
      <div class="message-container sent">
        <!-- Sender's name and timestamp container -->
        <div class="metadata" style="text-align: right;">
          <a href="" class="" style="color: rgb(56, 88, 152); text-decoration: none;" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal"> <i class="material-icons">&#xe872;</i></a>
          <span style="color: red;"><i class="bi bi-x"></i>Your Name</span>
          <span>01/02/2001 20:00</span>


        </div>

        <!-- Message text -->
        <div class="message sent">
          This is a sent message ádasd áda dấd ád ád áda dá da sdasd ádasd ádasdasd ádasdasd ádasdasd.
        </div>

      </div>

      <div class="message-container sent">
        <!-- Sender's name and timestamp container -->
        <div class="metadata" style="text-align: right;">
          <a href="" class="" style="color: rgb(56, 88, 152); text-decoration: none;" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal"> <i class="material-icons">&#xe872;</i></a>
          <span style="color: red;">Your Name</span>
          <span>01/02/2001 20:00</span>
        </div>

        <!-- Image message -->
        <div class="message sent" onclick="openModal('avata.jpg')">

          <img src="avata.jpg" alt="Sent Image" style="max-width: 250px;">

        </div>
      </div>
      <div class="message-container sent">
        <!-- Sender's name and timestamp container -->
        <div class="metadata" style="text-align: right;">
          <a href="" class="" style="color: rgb(56, 88, 152); text-decoration: none;" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal"> <i class="material-icons">&#xe872;</i></a>
          <span style="color: red;">Your Name</span>
          <span>01/02/2001 20:00</span>
        </div>

        <!-- File message -->
        <div class="message sent">
          <a style="color: white;" href="avata.jpg" target="_blank">Sent PDF File: file.pdf</a>
        </div>
      </div>
      <div class="message-container received">
        <!-- Sender's avatar and name container -->
        <div class="metadata" style="text-align: left; display: flex;">
          <!-- Avatar -->
          <img src="avata.jpg" alt="Received Avatar" class="avatar" style="margin-right: 10px;">

          <!-- Sender's name and timestamp container -->
          <div style="margin-left: 10px;">
            <span style="color: red;">Sender's Name</span>
            <span>01/02/2001 20:00</span>
          </div>
        </div>

        <!-- Message text -->
        <div class="message received">
          This is a received messageaaaaaaa aaaaaaaaaa aaaaaaaaaaa aaaaaaaaa aaaaaaaaa sssssss sssssss.
        </div>
      </div>
      <div class="message-container received">
        <!-- Sender's avatar and name container -->
        <div class="metadata" style="text-align: left; display: flex;">
          <!-- Avatar -->
          <img src="avata.jpg" alt="Received Avatar" class="avatar" style="margin-right: 10px;">

          <!-- Sender's name and timestamp container -->
          <div style="margin-left: 10px;">
            <span style="color: red;">Sender's Name</span>
            <span>01/02/2001 20:00</span>
          </div>
        </div>

        <!-- Image message -->
        <div class="message received" onclick="openModal('avata.jpg')">

          <img src="avata.jpg" alt="Sent Image" style="max-width: 250px;">

        </div>
      </div>
      <div class="message-container received">
        <!-- Sender's avatar and name container -->
        <div class="metadata" style="text-align: left; display: flex;">
          <!-- Avatar -->
          <img src="avata.jpg" alt="Received Avatar" class="avatar" style="margin-right: 10px;">

          <!-- Sender's name and timestamp container -->
          <div style="margin-left: 10px;">
            <span style="color: red;">Sender's Name</span>
            <span>01/02/2001 20:00</span>
          </div>
        </div>

        <!-- File message -->
        <div class="message received">
          <a href="path/to/received_file.pdf" target="_blank">Received PDF File: file.pdf</a>
        </div>
      </div>
    </div>
    <!-- Confirm Delete Modal -->
    <div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-labelledby="confirmDeleteModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="confirmDeleteModalLabel">Confirm Delete</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>Are you sure you want to delete this item?</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-danger">Delete</button>
          </div>
        </div>
      </div>
    </div>
    <div class="row message-form">
      <!-- <input class="col-md-7" type="text" id="message-input" placeholder="Nhập tin nhắn..."> -->
      <textarea class="col-md-7" rows="1" id="message-input" placeholder="Nhập tin nhắn..." oninput="autoExpand(this)" onkeydown="handleKeyPress(event)"></textarea>

      <button class="col-md-2" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>

      <!-- Thay thế nút chọn ảnh -->
      <label class="col-md-1" style="margin-right: 20px; margin-left: 20px;" for="image-input"
             class="file-input-label">
        <i class="fas fa-image"></i>
        <input style="display: none;" type="file" id="image-input" accept="image/*" onchange="sendImage()">
      </label>
      <!-- Thay thế nút chọn file -->
      <label class="col-md-1" for="file-input" class="file-input-label">
        <i class="fas fa-file"></i>
        <input style="display: none;" type="file" id="file-input" accept=".pdf, .doc, .docx"
               onchange="sendFile()">
      </label>

    </div>




  </div>
</div>


<div class="modal" id="imageModal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <img id="modalImage" alt="Enlarged Image">
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Add an event listener to the input element for the 'keypress' event
    document.getElementById('message-input').addEventListener('keypress', function (e) {
      // Check if the pressed key is 'Enter' (key code 13)
      if (e.key === 'Enter') {
        // Call the sendMessage function
        sendMessage();
      }
    });
  });
  function autoExpand(textarea) {
    // Reset the height to the default size to ensure it shrinks when content is removed
    textarea.style.height = 'auto';

    // Set the height of the textarea to its scrollHeight if it's less than the maximum allowed height (3 lines)
    textarea.style.height = Math.min(textarea.scrollHeight, 3 * parseInt(getComputedStyle(textarea).lineHeight)) + 'px';
  }

  function handleKeyPress(event) {
    // Check if Shift + Enter is pressed
    if (event.key === 'Enter' && event.shiftKey) {
      // Prevent the default behavior (new line) and instead insert a newline character
      event.preventDefault();
      const textarea = document.getElementById('message-input');
      const currentCursorPosition = textarea.selectionStart;
      const textBeforeCursor = textarea.value.substring(0, currentCursorPosition);
      const textAfterCursor = textarea.value.substring(currentCursorPosition);
      textarea.value = textBeforeCursor + '\n' + textAfterCursor;

      // Automatically expand the textarea
      autoExpand(textarea);
    }
  }
  function sendMessage() {
    const inputElement = document.getElementById('message-input');
    const message = inputElement.value.trim();

    if (message !== '') {
      const chatMessagesElement = document.getElementById('chat-messages');
      const messageContainer = document.createElement('div');
      messageContainer.className = 'message-container sent';

      // Add the sender's name and timestamp
      const metadataElement = document.createElement('div');
      metadataElement.className = 'metadata';
      metadataElement.style.textAlign = 'right'; // Set text-align to left

      const senderNameElement = document.createElement('span');
      senderNameElement.textContent = ' Your Name'; // Replace with the sender's name
      senderNameElement.style.color = 'red'; // Add float: left


      const timestampElement = document.createElement('span');
      timestampElement.textContent = getCurrentTime(); // Function to get the current timestamp
      metadataElement.appendChild(timestampElement);
      metadataElement.appendChild(senderNameElement);

      messageContainer.appendChild(metadataElement);

      // Add the message text with newline characters
      const messageElement = document.createElement('div');
      messageElement.className = 'message sent';
      messageElement.innerHTML = message.replace(/\n/g, '<br>'); // Handle newline characters

      messageContainer.appendChild(metadataElement);
      messageContainer.appendChild(messageElement);

      chatMessagesElement.appendChild(messageContainer);

      // Clear the input field after sending the message
      inputElement.value = '';

      // Simulate a received message (for demonstration purposes)
      setTimeout(receiveMessage, 1000);

      // Scroll to the bottom
      chatMessagesElement.scrollTop = chatMessagesElement.scrollHeight;

    }
  }

  function receiveMessage() {
    const chatMessagesElement = document.getElementById('chat-messages');
    const messageContainer = document.createElement('div');
    messageContainer.className = 'message-container received';

    // Add the sender's name and timestamp
    const metadataElement = document.createElement('div');
    metadataElement.className = 'metadata';
    metadataElement.style.textAlign = 'left'; // Set text-align to left
    metadataElement.style.display = 'flex'; // Use flex display

    // Add the avatar
    const avatarElement = document.createElement('img');
    avatarElement.src = 'avata.jpg'; // Replace with the correct path or URL
    avatarElement.alt = 'Received Avatar';
    avatarElement.className = 'avatar';
    metadataElement.appendChild(avatarElement);

    // Add the sender's name and timestamp container
    const senderInfoContainer = document.createElement('div');
    senderInfoContainer.style.marginLeft = '10px'; // Adjust margin as needed

    // Add the sender's name
    const senderNameElement = document.createElement('span');
    senderNameElement.textContent = 'They Name '; // Replace with the sender's name
    senderNameElement.style.color = 'red'; // Set the color to red

    // Add the timestamp
    const timestampElement = document.createElement('span');
    timestampElement.textContent = getCurrentTime(); // Function to get the current timestamp

    senderInfoContainer.appendChild(senderNameElement);
    senderInfoContainer.appendChild(timestampElement);

    metadataElement.appendChild(senderInfoContainer);
    messageContainer.appendChild(metadataElement);

    // Add the message text with newline characters
    const messageElement = document.createElement('div');
    messageElement.className = 'message received';
    messageElement.innerHTML = 'This is a received message.<br>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'; // Handle newline characters

    messageContainer.appendChild(messageElement);

    chatMessagesElement.appendChild(messageContainer);

    // Scroll to the bottom
    chatMessagesElement.scrollTop = chatMessagesElement.scrollHeight;
  }


  function getCurrentTime() {
    const now = new Date();
    const hours = now.getHours().toString().padStart(2, '0');
    const minutes = now.getMinutes().toString().padStart(2, '0');
    const day = now.getDate().toString().padStart(2, '0');
    const month = (now.getMonth() + 1).toString().padStart(2, '0'); // Months are zero-based
    const year = now.getFullYear();

    return `${day}/${month}/${year} ${hours}:${minutes}`;
  }
  function sendImage() {
    const inputElement = document.getElementById('image-input');
    const file = inputElement.files[0];

    if (file) {
      const chatMessagesElement = document.getElementById('chat-messages');
      const messageElement = document.createElement('div');
      messageElement.className = 'message sent';

      // Add the sender's name and timestamp
      const metadataElement = document.createElement('div');
      metadataElement.className = 'metadata';
      metadataElement.style.textAlign = 'right'; // Set text-align to left

      const senderNameElement = document.createElement('span');
      senderNameElement.textContent = ' Your Name'; // Replace with the sender's name
      senderNameElement.style.color = 'red'; // Add float: left


      const timestampElement = document.createElement('span');
      timestampElement.textContent = getCurrentTime(); // Function to get the current timestamp
      metadataElement.appendChild(timestampElement);
      metadataElement.appendChild(senderNameElement);

      chatMessagesElement.appendChild(metadataElement);

      // Add the image
      const imageElement = document.createElement('img');
      imageElement.src = URL.createObjectURL(file);
      imageElement.alt = 'Sent Image';
      imageElement.addEventListener('click', () => openModal(imageElement.src));

      // messageElement.appendChild(senderInfoContainer);
      messageElement.appendChild(imageElement);
      chatMessagesElement.appendChild(messageElement);

      // Clear the file input after sending the image
      inputElement.value = '';

      // Simulate a received message (for demonstration purposes)
      setTimeout(receiveMessage, 1000);

      // Scroll to the bottom
      chatMessagesElement.scrollTop = chatMessagesElement.scrollHeight;
    }
  }

  function sendFile() {
    const inputElement = document.getElementById('file-input');
    const file = inputElement.files[0];

    if (file) {
      const type = file.type.includes('pdf') ? 'pdf' : 'doc';
      const chatMessagesElement = document.getElementById('chat-messages');
      const messageElement = document.createElement('div');
      messageElement.className = 'message sent';

      // Add the sender's name and timestamp
      const metadataElement = document.createElement('div');
      metadataElement.className = 'metadata';
      metadataElement.style.textAlign = 'right'; // Set text-align to left

      const senderNameElement = document.createElement('span');
      senderNameElement.textContent = ' Your Name'; // Replace with the sender's name
      senderNameElement.style.color = 'red'; // Add float: left


      const timestampElement = document.createElement('span');
      timestampElement.textContent = getCurrentTime(); // Function to get the current timestamp
      metadataElement.appendChild(timestampElement);
      metadataElement.appendChild(senderNameElement);

      chatMessagesElement.appendChild(metadataElement);

      // Add the file name as a link
      const fileNameElement = document.createElement('a');
      fileNameElement.textContent = `Sent ${type.toUpperCase()} File: ${file.name}`;
      fileNameElement.href = URL.createObjectURL(file);
      fileNameElement.target = '_blank';

      // messageElement.appendChild(senderInfoContainer);
      messageElement.appendChild(fileNameElement);
      chatMessagesElement.appendChild(messageElement);

      // Clear the file input after sending the file
      inputElement.value = '';

      // Simulate a received message (for demonstration purposes)
      setTimeout(receiveMessage, 1000);

      // Scroll to the bottom
      chatMessagesElement.scrollTop = chatMessagesElement.scrollHeight;
    }
  }
  // function receiveMessage() {
  //     const chatMessagesElement = document.getElementById('chat-messages');
  //     const messageElement = document.createElement('div');
  //     messageElement.className = 'message received';

  //     // Add an avatar to the received message
  //     const avatarElement = document.createElement('img');
  //     avatarElement.src = 'avata.jpg'; // Replace with the correct path or URL
  //     avatarElement.alt = 'Received Avatar';
  //     avatarElement.className = 'avatar';
  //     messageElement.appendChild(avatarElement);

  //     // Add the message text
  //     const textElement = document.createElement('div');
  //     textElement.textContent = 'This is a received message.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa';
  //     messageElement.appendChild(textElement);

  //     chatMessagesElement.appendChild(messageElement);

  //     // Scroll to the bottom
  //     chatMessagesElement.scrollTop = chatMessagesElement.scrollHeight;
  // }

  function openModal(imageSrc) {
    const modal = document.getElementById('imageModal');
    const modalImage = document.getElementById('modalImage');

    modalImage.src = imageSrc;
    modal.style.display = 'flex';

    modal.addEventListener('click', closeModal);
  }

  function closeModal() {
    const modal = document.getElementById('imageModal');
    const modalImage = document.getElementById('modalImage');

    modal.style.display = 'none';
    modalImage.src = '';

    modal.removeEventListener('click', closeModal);
  }
</script>

</body>

</html>